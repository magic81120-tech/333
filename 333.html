<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Delong 304 CR price trend</title>
    <!-- 使用更稳定的ECharts CDN地址 -->
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <style>
        /* 确保页面占满视口 */
        html, body {
            margin: 0;
            padding: 0;
            height: 100%;
            overflow-x: hidden;
        }
        /* 图表容器样式 - 适配响应式 */
        #priceChart {
            width: 100%;
            max-width: 1200px;
            height: 600px;
            margin: 20px auto;
            border: 1px solid #eee;
            padding: 10px;
            box-sizing: border-box;
        }
        /* 加载提示 */
        .loading {
            text-align: center;
            padding: 20px;
            font-size: 16px;
            color: #666;
        }
    </style>
</head>
<body>
    <!-- 图表容器 -->
    <div id="priceChart">
        <div class="loading">正在加载数据...</div>
    </div>

    <script>
        // 确保DOM完全加载后再初始化图表
        document.addEventListener('DOMContentLoaded', function() {
            try {
                // 初始化ECharts实例
                const chartDom = document.getElementById('priceChart');
                // 清除加载提示
                chartDom.innerHTML = '';
                
                // 检查ECharts是否加载成功
                if (typeof echarts === 'undefined') {
                    throw new Error('ECharts库加载失败');
                }
                
                const myChart = echarts.init(chartDom);

                // 填充252个日期数据
                const dateData = [
                    '25.2.5', '25.2.6', '25.2.7', '25.2.8', '25.2.10', '25.2.11', '25.2.12', '25.2.13', '25.2.14', '25.2.17',
                    '25.2.18', '25.2.19', '25.2.20', '25.2.21', '25.2.24', '25.2.25', '25.2.26', '25.2.27', '25.2.28', '25.3.3',
                    '25.3.4', '25.3.5', '25.3.6', '25.3.7', '25.3.10', '25.3.11', '25.3.12', '25.3.13', '25.3.14', '25.3.17',
                    '25.3.18', '25.3.19', '25.3.20', '25.3.21', '25.3.24', '25.3.25', '25.3.26', '25.3.27', '25.3.28', '25.3.31',
                    '25.4.1', '25.4.2', '25.4.3', '25.4.7', '25.4.8', '25.4.9', '25.4.10', '25.4.11', '25.4.14', '25.4.15',
                    '25.4.16', '25.4.17', '25.4.18', '25.4.21', '25.4.22', '25.4.23', '25.4.24', '25.4.25', '25.4.27', '25.4.28',
                    '25.4.29', '25.4.30', '25.5.6', '25.5.7', '25.5.8', '25.5.9', '25.5.12', '25.5.13', '25.5.14', '25.5.15',
                    '25.5.16', '25.5.19', '25.5.20', '25.5.21', '25.5.22', '25.5.23', '25.5.26', '25.5.27', '25.5.28', '25.5.29',
                    '25.5.30', '25.6.3', '25.6.4', '25.6.5', '25.6.6', '25.6.9', '25.6.10', '25.6.11', '25.6.12', '25.6.13',
                    '25.6.16', '25.6.17', '25.6.18', '25.6.19', '25.6.20', '25.6.23', '25.6.24', '25.6.25', '25.6.26', '25.6.27',
                    '25.6.30', '25.7.1', '25.7.2', '25.7.3', '25.7.4', '25.7.7', '25.7.8', '25.7.9', '25.7.10', '25.7.11',
                    '25.7.14', '25.7.15', '25.7.16', '25.7.17', '25.7.18', '25.7.21', '25.7.22', '25.7.23', '25.7.24', '25.7.25',
                    '25.7.28', '25.7.29', '25.7.30', '25.7.31', '25.8.1', '25.8.4', '25.8.5', '25.8.6', '25.8.7', '25.8.8',
                    '25.8.11', '25.8.12', '25.8.13', '25.8.14', '25.8.15', '25.8.18', '25.8.19', '25.8.20', '25.8.21', '25.8.22',
                    '25.8.25', '25.8.26', '25.8.27', '25.8.28', '25.8.29', '25.9.1', '25.9.2', '25.9.3', '25.9.4', '25.9.5',
                    '25.9.8', '25.9.9', '25.9.10', '25.9.11', '25.9.12', '25.9.15', '25.9.16', '25.9.17', '25.9.18', '25.9.19',
                    '25.9.22', '25.9.23', '25.9.24', '25.9.25', '25.9.26', '25.9.28', '25.9.29', '25.9.30', '25.10.9', '25.10.10',
                    '25.10.11', '25.10.13', '25.10.14', '25.10.15', '25.10.16', '25.10.17', '25.10.20', '25.10.21', '25.10.22', '25.10.23',
                    '25.10.24', '25.10.27', '25.10.28', '25.10.29', '25.10.30', '25.10.31', '25.11.3', '25.11.4', '25.11.5', '25.11.6',
                    '25.11.7', '25.11.10', '25.11.11', '25.11.12', '25.11.13', '25.11.14', '25.11.17', '25.11.18', '25.11.19', '25.11.20',
                    '25.11.21', '25.11.24', '25.11.25', '25.11.26', '25.11.27', '25.11.28', '25.12.1', '25.12.2', '25.12.3', '25.12.4',
                    '25.12.5', '25.12.8', '25.12.9', '25.12.10', '25.12.11', '25.12.12', '25.12.15', '25.12.16', '25.12.17', '25.12.18',
                    '25.12.19', '25.12.22', '25.12.23', '25.12.24', '25.12.25', '25.12.26', '25.12.29', '25.12.30', '25.12.31', '26.1.4',
                    '26.1.5', '26.1.6', '26.1.7', '26.1.8', '26.1.9', '26.1.12', '26.1.13', '26.1.14', '26.1.15', '26.1.16',
                    '26.1.19', '26.1.20', '26.1.21', '26.1.22', '26.1.23', '26.1.26', '26.1.27', '26.1.28', '26.1.29', '26.1.30',
                    '26.2.2', '26.2.3','26.2.4'
                ];
                
                // 填充252个真实价格数据
                const priceData = [
                    13100, 13100, 13100, 13100, 13100, 13050, 12950, 13000, 12950, 12950,
                    12900, 12900, 13000, 13050, 13050, 13000, 13000, 13050, 13050, 13100,
                    13100, 13100, 13250, 13250, 13250, 13300, 13350, 13400, 13500, 13550,
                    13450, 13400, 13400, 13400, 13350, 13350, 13400, 13450, 13550, 13550,
                    13600, 13600, 13550, 13350, 13200, 13050, 13050, 13000, 13050, 13050,
                    13050, 13050, 13050, 13000, 13000, 13000, 13000, 12950, 12950, 12950,
                    12950, 12950, 12950, 12950, 12950, 12950, 13050, 13100, 13200, 13150,
                    13150, 13100, 13050, 13050, 13050, 13050, 13050, 13050, 13000, 12950,
                    12950, 12950, 12950, 12950, 12950, 12900, 12800, 12800, 12800, 12800,
                    12800, 12700, 12700, 12700, 12600, 12550, 12500, 12550, 12600, 12600,
                    12600, 12550, 12600, 12600, 12600, 12600, 12600, 12600, 12650, 12650,
                    12650, 12650, 12650, 12650, 12700, 12850, 12850, 12850, 12850, 12900,
                    12850, 12850, 12900, 12850, 12850, 12900, 12900, 12900, 12950, 12950,
                    13100, 13100, 13100, 13050, 13000, 13000, 13000, 12950, 12900, 12900,
                    13000, 13000, 13000, 13000, 13000, 13100, 13150, 13100, 13100, 13050,
                    13050, 13050, 13050, 13050, 13050, 13200, 13200, 13100, 13100, 13100,
                    13100, 13100, 13100, 13100, 13050, 13050, 13050, 13050, 13050, 13050,
                    12950, 12900, 12850, 12850, 12850, 12850, 12850, 12900, 12900, 12900,
                    12950, 12950, 12900, 12900, 12900, 12850, 12800, 12800, 12700, 12700,
                    12700, 12700, 12650, 12600, 12600, 12550, 12550, 12550, 12500, 12500,
                    12500, 12450, 12500, 12550, 12550, 12500, 12550, 12550, 12550, 12550,
                    12600, 12650, 12650, 12650, 12700, 12700, 12600, 12500, 12550, 12550,
                    12650, 12750, 12800, 12950, 12900, 12900, 12900, 13000, 13100, 13100,
                    13100, 13250, 13800, 13500, 13700, 13700, 13750, 13800, 14200, 14150,
                    14050, 14200, 14350, 14350, 14350, 14450, 14300, 14250, 14350, 14200,
                    14150, 13900, 13900
                ];

                // 计算要显示的5个日期索引：首尾+中间3个均匀分布的索引
                const totalLength = dateData.length;
                // 固定显示的索引：第一个(0)、最后一个(totalLength-1)
                // 中间3个索引：按总长度4等分（0, 1/4, 2/4, 3/4, 1）
                const showIndexes = [
                    0,  // 第一个数据
                    Math.floor(totalLength * 0.25),  // 1/4位置
                    Math.floor(totalLength * 0.5),   // 中间位置
                    Math.floor(totalLength * 0.75),  // 3/4位置
                    totalLength - 1  // 最后一个数据
                ];

                // ECharts配置项
                const option = {
                    title: {
                        text: 'Delong 304 CR price trend',
                        left: 'center',
                        textStyle: {
                            fontSize: 16,
                            fontWeight: 'bold'
                        }
                    },
                    tooltip: {
                        trigger: 'axis',
                        formatter: function(params) {
                            const date = params[0].name;
                            const price = params[0].value;
                            return `${date}<br/>${price} CNY/TON`;
                        },
                        backgroundColor: 'rgba(0,0,0,0.8)',
                        textStyle: { color: '#fff' },
                        borderRadius: 4,
                        padding: 8
                    },
                    xAxis: {
                        type: 'category',
                        data: dateData,
                        name: 'DATE',
                        nameTextStyle: {
                            color: '#ff0000',
                            fontWeight: 'bold',
                            fontSize: 14
                        },
                        nameLocation: 'end',
                        nameGap: 10,
                        axisLabel: {
                            rotate: 0,
                            fontSize: 12,
                            // 核心：只在指定的5个索引位置显示标签
                            interval: function(index) {
                                return showIndexes.includes(index);
                            },
                            margin: 8,
                            align: 'center'
                        },
                        axisTick: {
                            alignWithLabel: true,
                            // 刻度线只在显示标签的位置显示
                            interval: function(index) {
                                return showIndexes.includes(index);
                            }
                        },
                        splitLine: {
                            show: false
                        }
                    },
                    yAxis: {
                        type: 'value',
                        min: 12000,
                        max: 14500,
                        name: 'CNY/TON',
                        nameTextStyle: {
                            color: '#ff0000',
                            fontWeight: 'bold',
                            fontSize: 14
                        },
                        nameLocation: 'end',
                        nameGap: 20,
                        nameRotate: 0,
                        axisLabel: {
                            fontSize: 12
                        }
                    },
                    series: [
                        {
                            name: 'Price',
                            type: 'line',
                            data: priceData,
                            lineStyle: {
                                color: '#ff0000',
                                width: 2
                            },
                            symbol: 'none',
                            smooth: true
                        }
                    ],
                    grid: {
                        left: '6%',
                        right: '8%',
                        bottom: '12%',
                        top: '12%',
                        containLabel: true
                    }
                };

                // 渲染图表
                myChart.setOption(option);

                // 自适应窗口大小
                window.addEventListener('resize', function() {
                    myChart.resize();
                });
                
                console.log('图表初始化成功');
                console.log('显示的日期索引:', showIndexes);
                console.log('显示的日期:', showIndexes.map(idx => dateData[idx]));
                
            } catch (error) {
                // 错误处理
                console.error('图表加载失败:', error);
                const chartDom = document.getElementById('priceChart');
                chartDom.innerHTML = `<div style="text-align:center; padding:20px; color:red;">图表加载失败: ${error.message}</div>`;
            }
        });
    </script>
</body>
</html>